// Attendre que la page soit totalement chargée
window.onload = function() {
    // Initialisation du Canvas Fabric.js
    const canvas = new fabric.Canvas('main-canvas', {
        width: 450,
        height: 300,
        backgroundColor: '#fff'
    });

    // Fonction pour ajouter du texte
    window.ajouterTexte = function() {
        const text = new fabric.IText('Cliquez pour éditer', {
            left: 50,
            top: 50,
            fontFamily: 'Arial',
            fontSize: 25
        });
        canvas.add(text);
        canvas.setActiveObject(text);
    };

    // Changer la couleur du texte sélectionné
    document.getElementById('colorPicker').oninput = function() {
        const activeObject = canvas.getActiveObject();
        if (activeObject) {
            activeObject.set('fill', this.value);
            canvas.renderAll();
        }
    };

    // Effacer le canvas
    window.nettoyerCanvas = function() {
        if(confirm("Voulez-vous tout effacer ?")) {
            canvas.clear();
            canvas.setBackgroundColor('#fff', canvas.renderAll.bind(canvas));
        }
    };

    // Gestion de la commande
    document.getElementById('orderForm').onsubmit = function(e) {
        e.preventDefault();
        const mode = document.getElementById('paymentMethod').value;
        const imageDesign = canvas.toDataURL('png');
        
        alert("Succès ! Votre design NovaDesign a été enregistré.\nMode : " + mode);
        console.log("Image envoyée au serveur : ", imageDesign);
    };
};
